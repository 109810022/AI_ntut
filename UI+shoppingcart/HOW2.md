# AI ntut最終專題 智慧型購物車  
我們使用yolov8的影像辨識，達成可以在將物品放入購物車的同時進行儲存,並進行結帳，使得消費者可以減少購物結帳的時間 。 而且在未來將數據收集起來，結合大數據分析每個消費者的購買習慣，制定適合消費者的優惠方案。亦可結合商品的銷售量來取得最佳的進貨量。  

## 功能&實現方法
### 商品辨識:
#### 以yolov8為基礎視覺演算法訓練，訓練出一個基本的模型(best.pt)。目前模型可辨識麥香紅茶、奶茶、綠茶    
### 判斷放入&取出:
#### 設定一定範圍的偵測範圍，偵測商品和我們區域每一幀的交集面積，當面積遞增(減少)，則可以確定商品是取出(放入)  
### "偽"介面:  
#### 購買清單:讀取程式輸出之csv檔，並以cv2之繪製文字函式匯出文字在每一幀上  
#### 結帳按鈕:透過cv2建立一個按鈕方格，再建立滑鼠點擊事件(mouseclick event)，若點擊點在方框內，則中斷迴圈進入結帳輸出的函式  

### 成果圖
![螢幕擷取畫面 2023-06-11 150654](https://github.com/109810022/AI_ntut/assets/100888502/24efd968-5271-43b2-8608-4588bf2edb73)

## 背後算法
### 時間相關性:
因為影像辨識演算法並沒有時間連續性，只有每一幀的判斷而已。為將每幀的資料和時間結合成為和時間有關的資料，我設定一個一維的陣列，透過類似quene隊列 **先進先出(FIFO)** 的特性將資料推進陣列
。雖然結果會是離散的，但因為算出IOU的速度很快，每一個時間點的和前後時間點的差並不大，因此可以大略性的將每一個時間點的資料從離散的資料可視為連續性的，即可將IOU和時間相關的趨勢求出(取出或放入)。但顧及電腦算力可能不足，因此我只將每幀的資料和其前後兩幀做判斷。  
![Data_Queue svg](https://github.com/109810022/AI_ntut/assets/100888502/0bd37c38-1a2e-4c8a-b458-af0f45313073)  
圖片來源:https://en.wikipedia.org/wiki/Queue_%28abstract_data_type%29
### 動作連續性:
因為放入和取出的動作是具有連續性的，但在每一幀的取樣後會造成動作的離散化，進而導致動作被重複判斷，無法正確的判斷放入及取出的次數。解決方法一樣是透過類似quene隊列的特性，將每一次從判斷取出(放入)的種類投入陣列，再次將時間和被離散的動作重新結合
並連續化，因此只要找到連續化動作的斷點即可判斷動作是否已被判斷。

